\documentclass{amsart}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb,latexsym, tikz}

\newtheorem{thm}{Theorem}
\newtheorem{dfn}{Definition}
\newtheorem{lma}{Lemma}
\newtheorem{ex}{Example}
\newtheorem{clm}{Claim}


\newcommand{\CC}{\mathbb{C}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\bfa}{\mathbf{a}}
\newcommand{\bfn}{\mathbf{n}}


\renewcommand{\dim}{\mathrm{dim}}
\renewcommand{\Im}{\mathrm{Im}}

\title{Two-Step Flag Varieties via\\ Compatible Subsets of Maximal Dyck Paths}

\author{Colleen Robichaux}
\author{Dylan Rupel}
\author{Harshit Yadav}

\begin{document}
  \begin{abstract}
    We show that the affine cells in certain quiver Grassmannians can be labeled by compatible subsets of maximal Dyck paths.
    The dimensions of these cells are shown to be computable combinatorially, verifying an analogue of a conjecture of the second author and Thorsten Weist.
  \end{abstract}
  \maketitle

  Say something about quiver Grassmannians

  Say something about compatible subsets of maximal Dyck paths

  Let $D_n$ denote the maximal Dyck path $D_{(n,n)}$.
  Write $d_S=\sum\limits_{e<e'\in D_n} d_S(e,e')$, where
  \[
    d_S(e,e')=
    \begin{cases}
      -1 & \text{if $e\in S\cap H_n$ and $e'\in S\cap V_n$;}\\
      1 & \text{if $e\in S\cap H_n$ and $e'\in H_n\setminus S$;}\\
      1 & \text{if $e\in V_n\setminus S$ and $e'\in S\cap V_n$;}\\
      0 & \text{otherwise.}
    \end{cases}
  \]
  The following is an analogue of \cite[Conjecture 5.21]{rupel-weist}.
  \begin{thm}
    Given a compatible subset $S\subset D_n$ with $|S\cap H_n|=n-k_2$ and $|S\cap V_n|=k_1$, the affine cell in $Gr_{(k_1,k_2)}(\CC^n\leftarrow\CC^n)$ labeled by $S$ has dimension $d_S$.
  \end{thm}


  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \section{Compatible Subsets of Maximal Dyck Paths}
  Given $\bfa\in\ZZ_{\ge0}^2$, let $D_\bfa$ denote the maximal Dyck path in the lattice rectangle with corner vertices $(0,0)$ and $\bfa$.
  That is, $D_\bfa$ is the lattice path that begins at $(0,0)$, takes East and North steps to end at $\bfa$ while never passing above the main diagonal of the rectangle.
  It is maximal in the sense that any lattice point lying above $D_\bfa$ also lies above the main diagonal.
  Write $H_\bfa:=\{h_1,\cdots,h_{a_1}\}$ (resp. $V_\bfa:=\{v_1,\ldots,v_{a_2}\}$) for the set of horizontal (resp. vertical) edges in $D_\bfa$ taken in the natural order from $(0,0)$ to $\bfa$.

  \begin{dfn}
    Fix $r\ge1$.
    A subset $S\subset H_\bfa\sqcup V_\bfa$ is \emph{$r$-compatible} if: for each $h\in H_\bfa$ and $v\in V_\bfa$ with $h<v$, there exists an edge $e$ with $h\le e\le v$ so that at least one of the following holds
    \[e\ne v \qquad \text{and} \qquad \big|\{v'\in V_\bfa:h\le v'\le e\}\big|=r\big|\{h'\in H_\bfa\cap S:h\le h'\le e\}\big|\]
    \[e\ne h \qquad \text{and} \qquad \big|\{h'\in H_\bfa:e\le h'\le v\}\big|=r\big|\{v'\in V_\bfa\cap S:e\le v'\le v\}\big|\]
  \end{dfn}


  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \section{Bijection with permutations}
  Let $F(k_1,k_2;n)$ denote the $2$-step flag variety of tuples of vector subspaces $(V_1,V_2)$ of a fixed $n$-dimensional vector space $V$, where $\dim(V_1)=k_1$, $\dim(V_2)=k_2$, and $V_1\subset V_2$.
  The cohomology ring of the $2$-step flag variety is generated by the Poincare duals of the classes of Schubert varieties in $F(k_1,k_2;n)$.
  These Schubert varieties are parameterized by permuatations $w\in W(k_1,k_2)\subset S_n$ where
  \[W(k_1,k_2):=\{w\in S_n \ | \ w(i)<w(i+1) \ \mbox{ if } \ i\in [n]\backslash \{k_1,k_2\}\},\]
  such permuataions are called \emph{$2$-Grassmannian permutations}.

  It is well known that the dimension of the Schubert variety corresponding to the permutation $w$ (denoted $\sigma_w$) is equal to the number of inversions of $w$: 
  \[\ell(w):=\#\{1\leq i<j\leq n \ | \ w(i)>w(j)\}.\]

  \begin{ex}
    \label{ex:2step}
    For $n=8$, we see $w=25378146$ is $2$-Grassmanian since $i\notin\{2,5\}$ implies $w(i)<w(i+1)$ and so $w\in W(2,5)$. 
    In this case, we have $\ell(w)=10$.
    %Similarly $v=46123578$ is $2$-Grassmanian where, so $k_1=2$ and $k_2=8$. 
  \end{ex}

  Define 
  \[ S(k_1,k_2):= \{ S\subset D_n  \ | \  |S\cap H_n|=k_1, |S\cap V_n|=n-k_2\} \]

  %%%%%%feel free to change notation if you see a better choice for phi 
  For a fixed choice of $k_1<k_2$, we define a map $\phi_{k_1,k_2}:W(k_1,k_2)\to S(k_1,k_2)$ as follows.
  Suppose that $w =(w_1,w_2,\ldots,w_n)  \in W(k_1,k_2)$.
  Define $S_w:=\phi_{k_1,k_2} (w)$ to be the subset of $D_n$ such that $S_w \cap H_n=\{ h_{w_{k_2 +1}}, h_{w_{k_2 +2}}, \ldots, h_{w_n} \}$ and $S_w \cap V_n = \{v_{w_1},v_{w_2},\ldots,v_{w_{k_1}}\}$.

  \begin{ex}
    \label{ex:phiW}
    %%%%%fix notation of V_n as set and V_n as edge
    For $w=25378146$ as in Example~\ref{ex:2step}, we have $S_w \cap H_8=\{ h_{w_{6}},h_{w_{7}}, h_{w_8} \}=\{ 1,4, 6 \}$ and $S_w \cap V_8 = \{v_{w_1},v_{w_2}\}= \{2,5\}$.
    Below is $D_8$ with $S_w$ in red. 
    \begin{center} 
      \begin{tikzpicture}[scale=0.5]
        (0,0) rectangle +(8,8);
        \draw[help lines] (0,0) grid +(8,8);
        \draw[dashed] (0,0) -- +(8,8);
        % \coordinate (prev) at (8,0);
        \draw [color=red,line width=2] (0,0)--(1,0);
        \draw [line width=1] (1,1)--(2,1);
        \draw [line width=1] (2,2)--(3,2);
        \draw [color=red,line width=2] (3,3)--(4,3);
        \draw [line width=1] (4,4)--(5,4);
        \draw [color=red,line width=2] (5,5)--(6,5);
        \draw [line width=1] (6,6)--(7,6);
        \draw [line width=1] (7,7)--(8,7);

        \draw [line width=1] (1,0)--(1,1);
        \draw [color=red,line width=2] (2,1)--(2,2);
        \draw [line width=1] (3,2)--(3,3);
        \draw [line width=1] (4,3)--(4,4);
        \draw [color=red,line width=2] (5,4)--(5,5);
        \draw [line width=1] (6,5)--(6,6);
        \draw [line width=1] (7,6)--(7,7);
        \draw [line width=1] (8,7)--(8,8);

        %\draw [color=red, line width=1] (8,0)--(9,0)--(10,0)--(10,1)--(10,2)--(13,2)--(13,3)--(13,5);

        \draw (0,0) node [scale=0.3, circle, draw,fill=black]{};
        \draw (1,1) node [scale=0.3, circle, draw,fill=black]{};
        \draw (2,2) node [scale=0.3, circle, draw,fill=black]{};
        \draw (3,3) node [scale=0.3, circle, draw,fill=black]{};
        \draw (4,4) node [scale=0.3, circle, draw,fill=black]{};
        \draw (5,5) node [scale=0.3, circle, draw,fill=black]{};
        \draw (6,6) node [scale=0.3, circle, draw,fill=black]{};
        \draw (7,7) node [scale=0.3, circle, draw,fill=black]{};
        \draw (8,8) node [scale=0.3, circle, draw,fill=black]{};

        \draw (1,0) node [scale=0.3, circle, draw,fill=black]{};
        \draw (2,1) node [scale=0.3, circle, draw,fill=black]{};
        \draw (3,2) node [scale=0.3, circle, draw,fill=black]{};
        \draw (4,3) node [scale=0.3, circle, draw,fill=black]{};
        \draw (5,4) node [scale=0.3, circle, draw,fill=black]{};
        \draw (6,5) node [scale=0.3, circle, draw,fill=black]{};
        \draw (7,6) node [scale=0.3, circle, draw,fill=black]{};
        \draw (8,7) node [scale=0.3, circle, draw,fill=black]{};
      \end{tikzpicture}
    \end{center}
  \end{ex}


  %Take $\phi_{k_1,k_2}(id):=S_{id}$ where $S_{id}\cap H_n=\{h_1,\ldots,h_{n-k_1}\}$ and $S_{id}\cap V_n=\{v_{n-k_2},\ldots,v_{n}\}$. 

  %Show we can get everything by applying simple transp. to id, all remaining in $W(k_1,k_2)$.

  %Then any other $w\in W(k_1,k_2)$

  \begin{lma}
    \label{lma:mapCompat}
    If $w\in W(k_1,k_2)$, then $S_w$ is a compatible subset of $D_n$.
  \end{lma}
  \begin{proof}
    Since $w$ is a permutation, $i\neq j$ means that $w_i\neq w_j$.
    Thus, it is straightforward to see that the horizontal and vertical edges are always at different positions.
    Therefore, $S_w$ is a compatible subset of $D_n$.
  \end{proof}

  \begin{lma}
    \label{lma:bij}
    The map $\phi_{k_1,k_2}:W(k_1,k_2)\to S(k_1,k_2)$ is a bijection.
  \end{lma}
  \begin{proof}
    It is easy to see that $\phi$ is an injective map since $w$ being a $2$-Grassmanian permutation from $W(k_1,k_2)$ uniquely determines $w_{k_1+1},\ldots,w_{k_2}$, given $w_{1},\ldots,w_{k_1}$ and $w_{k_2+1},\ldots,w_{n}$.
    Given any compatible subset $S\in S(k_1,k_2)$, we construct a permutation $w\in W(k_1,k_2)$ such that $S_w=S$.
    Suppose that $S\cap V_n = \{v_{i_1},\ldots,v_{i_{k_1}} \}$ with $i_1<\ldots<i_{k_1}$ and that $S\cap H_n=\{ h_{j_1},h_{j_2},\ldots, h_{j_{n-k_2}} \}$ with $j_1<\ldots<j_{n-k_2}$.
    From this, we set $\{m_1, \ldots,m_{n-k_1-k_2}\} = [n]\backslash \{i_1,\ldots,i_{k_1},j_1,\ldots,j_{n-k_2} \}$ sorted in ascending order, i.e. $m_i<m_j$ if $i<j$.

    Then we define $w$ as follows
    \[
      w_k= 
      \begin{cases}
        i_k & \text{if $k\leq k_1$};\\
        m_{k-k_1} & \text{if $k_1< k \leq k_2 $;}\\
        j_{k-k_2} & \text{if $k > k_2 $;}\\
      \end{cases}
    \]
    It follows from the construction of $w$ that $S_{w}=S$.
  \end{proof}

  \begin{lma}
    \label{lma:lenMatch}
    For $w\in W(k_1,k_2)$, we have $\ell(w)=d_{S_w}$.
  \end{lma}
  \begin{proof}
    First we define a quantity $\widetilde{d}_S$. 
    For this, we define a map $\nu:D_n\to D_n$ by $\nu(h_i)=v_i$ and $\nu(v_i)=h_i$
    Then $\widetilde{d}_S=\sum\limits_{e<e'\in D_n} \widetilde{d}_S(e,e')$, where
    \[
      \widetilde{d}_S(e,e')=
      \begin{cases}
        % -1 & \text{if $e\in S\cap H_\bfn$ and $e'\in S\cap V_\bfn$;}\\
        1 & \text{if $e\in S\cap H_n$,  $e'\in H_n\setminus S$, and $\nu(e')\in V_n\setminus S$;}\\
        1 & \text{if $e\in V_n\setminus S$ and $e'\in S\cap V_n$;}\\
        0 & \text{otherwise.}
      \end{cases}
    \]

    By Lemma~\ref{lma:mapCompat}, $S$ is a compatible subset.
    Thus if $e\in S\cap H_n$ then $\nu(e)\in V_n\setminus S$ (and similarly if $e\in S\cap V_n$), then $\nu(e)\in H_n\setminus S$. 
    Therefore $\widetilde{d}_S=d_S$.

    We see $\ell(w)=\sum\limits_{1\leq i<j\leq n} \ell(i,j)$, where 
    \[
      \ell(i,j)=
      \begin{cases}
        1 & \text{if } w_i>w_j\\
        0 & \text{otherwise.}
      \end{cases}
    \]
 
    Let $w^{(1)}:=w_1,\ldots,w_{k_1}$, $w^{(2)}:=w_{k_1+1},\ldots,w_{k_2}$, and $w^{(3)}:=w_{k_2+1},\ldots,w_{n}$. 
 
    Define a map $\Phi':[n]\times [n]\rightarrow D_n\times D_n$ as
    \[
      \Phi'(i,j):=
      \begin{cases}
        (v_{w_i},v_{w_j}) & \text{if } i\in[1,\ldots,k_1]\\
        (h_{w_i},h_{w_j}) & \text{if } i\in[k_2+1,\ldots,n].
      \end{cases}
    \]

    Write $[n]^{(2)}\subset [n]\times[n]$ for the subset consisting of pairs $(i,j)$ with $i<j$.
    Then define $\Phi:[n]^{(2)}\to D_n\times D_n$ by
    \[
      \Phi(i,j):=
      \begin{cases}
        (e,e') & \text{if } w_i<w_j;\\
        (e',e) & \text{if } w_i>w_j;
      \end{cases}
    \]
    when $\Phi'(i,j)=(e,e')$. 
 
    \begin{clm}
      \label{clm:pairMatch}
      For $1\leq i<j\leq n$,  the following hold:
      \begin{itemize}
        %\item $\Phi$ is injective
        \item[(i)] $\ell(i,j)=\widetilde{d}_S(\Phi(i,j))$
        \item[(ii)] If $(e,e')\notin\Im(\Phi)$, then $\widetilde{d}_S(e,e')=0$.
      \end{itemize}
    \end{clm}

    If Claim~\ref{clm:pairMatch} holds, 
    \[\ell(w)=\sum\limits_{1\leq i<j\leq n} \ell(i,j)=\sum\limits_{1\leq i<j\leq n} \widetilde{d}_S(\Phi(i,j))=\sum\limits_{e<e'\in D_n} \widetilde{d}_S(e,e')=\widetilde{d}_S={d}_S,\]
    which proves the Lemma.\\

    \noindent\emph{Proof of Claim \ref{clm:pairMatch}:}
    The proof of (i) follows by casework of $i,j$ in intervals $I_1=[1,\ldots,k_1]$, $I_2=[k_1+1,\ldots,k_2]$, and $I_3=[k_2+1,\ldots,n]$.\\ 

    \noindent {\sf Case 1:}($i,j\in I_m$ where $1\leq m\leq 3$) 
    Since $w\in W(k_1,k_2)$, if $i,j\in I_m$ then $w_i<w_j$, so $\ell(i,j)=0$. 
    If $m=1$, $\Phi(i,j)=(v_{w_i},v_{w_j})$. 
    By the definition of $S$, $v_{w_i}\in S\cap V_n$, so $\widetilde{d}_S(v_{w_i},v_{w_j})=0$.
    If $m=2$, $\Phi(i,j)=(h_{w_i},h_{w_j})$. 
    By the definition of $S$, $h_{w_i}\notin S\cap h_\bfn$, so $\widetilde{d}_S(h_{w_i},h_{w_j})=0$.
    Finally if $m=3$, $\Phi(i,j)=(h_{w_i},h_{w_j})$. 
    By the definition of $S$, $h_{w_i},h_{w_j}\in S\cap H_n$, so $\widetilde{d}_S(h_{w_i},h_{w_j})=0$.\\

    \noindent {\sf Case 2:}($i\in I_1$ and $j\in I_{2}\cup I_3$)
    If $w_i<w_j$, then $\ell(i,j)=0$.
    Further $\Phi(i,j)=(v_{w_i},v_{w_j})$, so $\widetilde{d}_S(\Phi(i,j))=0$ since $h_{w_i}\in S\cap V_n$.
    If $w_i>w_j$, then $\ell(i,j)=1$.
    Furthermore $\Phi(i,j)=(v_{w_j},v_{w_i})$, so since $v_{w_j}\in V_n\setminus S$ and $v_{w_i}\in S\cap V_n$, we have $\widetilde{d}_S(\Phi(i,j))=1$.\\

    \noindent {\sf Case 3:}($i\in I_2$ and $j\in I_{3}$)
    If $w_i<w_j$, then $\ell(i,j)=0$.
    Furthermore $\Phi(i,j)=(h_{w_i},h_{w_j})$, so $\widetilde{d}_S(\Phi(i,j))=0$ since $h_{w_i}\in H_n\setminus S$.
    If $w_i>w_j$, then $\ell(i,j)=1$.
    Further $\Phi(i,j)=(h_{w_j},h_{w_i})$, so $\widetilde{d}_S(\Phi(i,j))=1$ since $h_{w_j}\in S\cap H_n$, $h_{w_i}\in H_n\setminus S$, and $v_{w_i}\in V_n\setminus S$.

    This clearly exhausts all cases with $i<j$. 
    Thus it remains to check that if $(e,e')\not\in$Im$\Phi$, then $\widetilde{d}_S(e,e')=0$.

    Consider the subset $U\subset D_n\times D_n$ which contains all elements of the following forms for $1\leq k'\leq k\leq n$:
    \begin{itemize}
      \item $(h_k, v_{k'})$;
      \item $(v_k, h_{k'})$;
      \item $(v_k, v_{k'})$, where $k<k'\in I_2\cup I_3$;
      \item $(h_k, h_{k'})$, where $k\in I_1\cup I_2$;
      \item $(H_k, H_{k'})$ where $k\in I_3$, $k'\in I_1$;
    \end{itemize}
    Using the definitions of $S$ and $\Phi$, it is straightforward to check that $D_n\times D_n\setminus $Im$\Phi\subseteq U$.
    Further it is clear from the definition of $\widetilde{d}_S$ that if $(e,e')\in U$, $\widetilde{d}_S(e,e')=0$.
    Thus the result follows.
  \end{proof}

\end{document}
